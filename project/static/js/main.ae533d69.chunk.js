(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(t,e,n){},15:function(t,e,n){},18:function(t,e,n){"use strict";n.r(e);var i=n(0),a=n.n(i),c=n(7),o=n.n(c),r=(n(13),n(1)),l=n(2),s=n(4),u=n(3),d=n(5),m=(n(15),function(t){function e(){return Object(r.a)(this,e),Object(s.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this.props,e=t.country,n=t.index,i=t.click,c=t.active;return a.a.createElement("div",{className:c?"country-container selected":"country-container",onClick:function(){return i(n)}},a.a.createElement("div",{className:"title"},e.title),a.a.createElement("div",null,e.text))}}]),e}(i.Component)),h=function(t){function e(t){var n;Object(r.a)(this,e),(n=Object(s.a)(this,Object(u.a)(e).call(this,t))).titleChange=function(t){n.setState({title:t.target.value})},n.descChange=function(t){n.setState({desc:t.target.value})};var i=n.props,a=i.data,c=i.countryPk;return Object.keys(a).length>0?n.state={title:a.title,desc:a.desc,pk:a.pk}:n.state={title:"",desc:"",country_pk:c},n}return Object(d.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=this.props,n=e.data,i=e.submit,c=e.cancel,o=this.state,r=o.title,l=o.desc;return a.a.createElement("div",{className:"form-container"},a.a.createElement("div",{className:"title"},Object.keys(n).length>0?"Edit city ".concat(n.title):"Add City"),a.a.createElement("input",{className:"input-field",placeholder:"City name...",onChange:this.titleChange,value:r}),a.a.createElement("textarea",{rows:"4",className:"input-field",placeholder:"City description...",onChange:this.descChange,value:l}),a.a.createElement("div",{onClick:function(){return i(t.state)},className:"pull-left button primary pull-left"},"Submit"),a.a.createElement("div",{onClick:c,className:"button pull-left"},"Cancel"),a.a.createElement("div",{className:"clearfix"}))}}]),e}(i.Component),f=function(t){function e(){return Object(r.a)(this,e),Object(s.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(d.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this.props,e=t.auth,n=t.city,i=t.editCityPk,c=t.editButtonClick,o=t.cancel,r=t.submit,l=t.del;return a.a.createElement("div",null,n.pk===i?a.a.createElement(h,{data:n,submit:r,cancel:o}):a.a.createElement("div",{className:"cities-item"},e&&a.a.createElement("div",{className:"actions-container"},a.a.createElement("span",{className:"action-item",onClick:function(){return c(n.pk)}},"edit"),a.a.createElement("span",{className:"action-item",onClick:function(){return l(n)}},"delete")),a.a.createElement("div",{className:"pull-left"},a.a.createElement("div",{className:"cities-title"},n.title),a.a.createElement("div",null,n.desc)),a.a.createElement("div",{className:"clearfix"})))}}]),e}(i.Component),p=(n(17),function(){return fetch("/api/v1/",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then(function(t){return t.json()})}),C=function(){return fetch("/api/v1/auth/",{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then(function(t){return t.json()})},k=function(t){return fetch("/api/v1/",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})},y=function(t){return fetch("/api/v1/",{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})},v=function(t){return fetch("/api/v1/",{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)})},E=function(t){function e(t){var n;return Object(r.a)(this,e),(n=Object(s.a)(this,Object(u.a)(e).call(this,t))).componentDidMount=function(){var t=n.state.activeCountry;p().then(function(e){e.length>0&&n.setState({countries:e,cities:e[t].cities,countryPk:e[t].pk})}),C().then(function(t){n.setState({auth:t})})},n.countryClick=function(t){var e=n.state.countries;n.setState({activeCountry:t,cities:e[t].cities,countryPk:e[t].pk,showAddForm:!1})},n.addButtonClick=function(){n.setState({showAddForm:!0})},n.addCancelClick=function(){n.setState({showAddForm:!1})},n.addSubmitClick=function(t){t.title&&k(t).then(function(){p().then(function(t){n.setState({showAddForm:!1,cities:t[n.state.activeCountry].cities,countries:t})})})},n.editButtonClick=function(t){n.setState({editCityPk:t})},n.editCancelClick=function(){n.setState({editCityPk:0})},n.editSubmitClick=function(t){t.title&&y(t).then(function(){p().then(function(t){n.setState({countries:t,cities:t[n.state.activeCountry].cities,editCityPk:0})})})},n.deleteClick=function(t){var e=n.state.cities;window.confirm("Delete information about the ".concat(t.title,"?"))&&v(t).then(function(){p().then(function(i){n.setState({countries:i,cities:e.filter(function(e){return e.pk!==t.pk})})})})},n.state={countries:[],activeCountry:0,countryPk:0,cities:[],auth:!1,showAddForm:!1,editCityPk:0},n}return Object(d.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=this.state,n=e.countries,i=e.cities,c=e.activeCountry,o=e.auth,r=e.showAddForm,l=e.editCityPk,s=e.countryPk;return a.a.createElement("div",null,a.a.createElement("header",{className:"header"},a.a.createElement("div",{className:"container"},"Countries of the World")),a.a.createElement("main",{className:"container"},a.a.createElement("div",{className:"countries-column"},a.a.createElement("h4",null,"Countries"),n.length>0&&n.map(function(e,n){return a.a.createElement(m,{key:"country"+n,active:n===c,country:e,index:n,click:t.countryClick})})),a.a.createElement("div",{className:"cities-column"},a.a.createElement("h4",null,"Cities"),a.a.createElement("div",{className:"cities-container"},o&&a.a.createElement("div",{className:"form-item"},r?a.a.createElement(h,{countryPk:s,data:{},cancel:this.addCancelClick,submit:this.addSubmitClick}):a.a.createElement("div",{className:"button primary",onClick:this.addButtonClick},"+ Add city")),i.length>0&&i.map(function(e,n){return a.a.createElement(f,{key:"city"+n,city:e,editCityPk:l,editButtonClick:t.editButtonClick,cancel:t.editCancelClick,submit:t.editSubmitClick,del:t.deleteClick,auth:o})})))),a.a.createElement("footer",{className:"footer"},a.a.createElement("div",{className:"container"},"Test task")))}}]),e}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(t){t.unregister()})},8:function(t,e,n){t.exports=n(18)}},[[8,2,1]]]);
//# sourceMappingURL=main.ae533d69.chunk.js.map